<div id="chat-widget"></div>

<script>
  fetch("/chat-widget.html")
    .then(res => res.text())
    .then(html => {
      document.getElementById("chat-widget").innerHTML = html;

      // ğŸ”¥ NOW elements exist â€” attach JS
      const toggleBtn = document.getElementById("chat-toggle");
      const chatBox = document.getElementById("chat-box");
      const form = document.getElementById("chat-form");
      const input = document.getElementById("message-input");
      const messages = document.getElementById("messages");

      // Toggle rocket
      toggleBtn.addEventListener("click", () => {
        chatBox.style.display =
          chatBox.style.display === "flex" ? "none" : "flex";
      });

      // Send message
      form.addEventListener("submit", async (e) => {
        e.preventDefault();

        const text = input.value.trim();
        if (!text) return;

        messages.innerHTML += `
          <div class="msg-user mb-2">
            <span>${text}</span>
          </div>
        `;
        input.value = "";
        messages.scrollTop = messages.scrollHeight;

        const res = await fetch("/chat", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message: text }),
        });

        const data = await res.json();

        messages.innerHTML += `
          <div class="msg-bot mb-2">
            <span>${data.reply}</span>
          </div>
        `;
        messages.scrollTop = messages.scrollHeight;
      });
    });
</script>


<div class="container my-4">

  <!-- ================= IMMEDIATE ALERT ================= -->
  <div class="alert alert-danger border-0 shadow-sm">
    <h4 class="mb-2">ğŸš¨ Immediate Danger</h4>
    <p class="mb-2">
      If you or someone with you is in immediate danger, please seek help right now.
    </p>

    <div class="d-flex gap-3 flex-wrap">
      <a href="tel:112" class="btn btn-danger">
        ğŸ“ Call Emergency (112)
      </a>
      <a href="tel:9152987821" class="btn btn-outline-danger">
        ğŸ“ Mental Health Helpline (India)
      </a>
    </div>
  </div>

  <!-- ================= SUPPORT OPTIONS ================= -->
  <div class="row g-4 mt-1">

    <!-- HELPLINES -->
    <div class="col-md-6">
      <div class="card h-100 shadow-sm">
        <div class="card-body">
          <h5 class="card-title">ğŸ“ Crisis Helplines (India)</h5>

          <ul class="list-group list-group-flush mt-3">
            <li class="list-group-item">
              <strong>KIRAN Helpline</strong><br>
              1800-599-0019 (24/7)
            </li>
            <li class="list-group-item">
              <strong>AASRA</strong><br>
              91-9820466726
            </li>
            <li class="list-group-item">
              <strong>iCall</strong><br>
              9152987821
            </li>
          </ul>
        </div>
      </div>
    </div>

    <!-- IMMEDIATE COPING -->
    <div class="col-md-6">
      <div class="card h-100 shadow-sm">
        <div class="card-body">
          <h5 class="card-title">ğŸ§  Right Now â€“ What You Can Do</h5>

          <ul class="list-group list-group-flush mt-3">
            <li class="list-group-item">
              ğŸŒ¬ï¸ Breathe slowly â€” inhale 4 sec, exhale 6 sec
            </li>
            <li class="list-group-item">
              ğŸ‘€ Name 5 things you can see around you
            </li>
            <li class="list-group-item">
              âœï¸ Write what youâ€™re feeling (no judgment)
            </li>
            <li class="list-group-item">
              ğŸ¤ Contact someone you trust
            </li>
          </ul>
        </div>
      </div>
    </div>

  </div>

  <!-- ================= WARNING SIGNS ================= -->
  <div class="card shadow-sm mt-4">
    <div class="card-body">
      <h5 class="card-title">âš ï¸ Warning Signs</h5>

      <div class="row mt-3">
        <div class="col-md-6">
          <ul class="small">
            <li>Talking about feeling hopeless</li>
            <li>Withdrawing from people</li>
            <li>Extreme mood changes</li>
          </ul>
        </div>
        <div class="col-md-6">
          <ul class="small">
            <li>Talking about death or self-harm</li>
            <li>Sleeping too little or too much</li>
            <li>Sudden risky behavior</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- ================= SAFETY NOTE ================= -->
  <div class="alert alert-warning small text-center mt-4">
    This app is not a replacement for professional care.  
    If you feel unsafe, please contact emergency services immediately.
  </div>

</div>
